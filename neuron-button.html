<link rel="import" href="../neuron-base/neuron-base.html">
<link rel="import" href="../paper-button/paper-button.html">

<!--
    TODO(polyup): Inheriting from other custom elements is not yet supported.
    See: https://www.polymer-project.org/1.0/docs/migration.html#inheritance
 -->
<dom-module id="neuron-button">
  <style>
			:host{
				display: flex;
			}

			:host paper-button{
				flex: 1;
				margin: 0px;
			}

			:host paper-button[disabled]{
				background: rgba(255,255,255, 0.5);
				color: gray;
			}


		</style>
  <template>
		<template is="dom-repeat" items="{{elems}}" as="value" index-as="i">
			<paper-button class="{{state}}" toggle="{{toggle}}" disabled="{{computeDisabled(state)}}" neuron-id="{{i}}" active?="{{computeActive(i)}}" on-tap="{{actionTapped}}">
				<span>{{label}}</span> <template is="dom-if" if="{{computeIf(neuronValues)}}">{{i}}</template>
			</paper-button>
		</template>

		<shadow></shadow>
	</template>
</dom-module>
<script>
    Polymer({
        is: 'neuron-button',
        behaviors: [DiyaBehaviors.Neuron],
        properties: {
            label: { notify: true },
            toggle: { type: Boolean, value: false, notify: true },
        },

        ready: function () {
        },

        actionTapped: function (evt) {
            if (!this.neuron) return;

            var neuronId = parseInt(evt.target.attributes['neuron-id'].value);
            var active = evt.target.active;
            if (this.toggle) {
                this.send(neuronId, active ? 1 : 0);
            } else {
                this.sendEvent(neuronId, 1000);
            }
        },

        computeDisabled: function (state) {
            return state === 'disconnected';
        },

        computeActive: function (i) {
            return this.neuronValues[i] ? true : false;
        },

        computeIf: function (neuronValues) {
            return neuronValues.length > 1;
        }
    });
</script>
